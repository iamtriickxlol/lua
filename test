getgenv().settings = {
	ws = nil;
	wsa = 16;
	Fly = nil;
	FlyBV = nil;
	flys = 70;
	Clip = nil;
	webhook = false;
	webhookURL = "";
	boss = false;
	antivoid = false;
}

local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")

local Player = Players.LocalPlayer
local Char = Player.Character or Player.CharacterAdded:Wait()
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/metauser08/lua/main/lib"))()
local ControlModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/metauser08/lua/main/cm"))()



local filename = game.Players.LocalPlayer.Name.. "-TypeSoul" .. "-settings.txt";
	
function loadsettings()

	local httpService = game:GetService("HttpService")
	if readfile and isfile and isfile("Meta Hub/"..filename) then
		getgenv().settings = httpService:JSONDecode(readfile("Meta Hub/"..filename))

	end

end

function saveSettings()
	
	local json
	local httpService = game:GetService("HttpService")
	if writefile and makefolder then
		
		json = httpService:JSONEncode(getgenv().settings)
		local settingsTXT = writefile("Meta Hub/"..filename, json)
		makefolder("Meta Hub")

	else
	
	end
end



local function walkspeed(toggle)
	if not toggle then
		getgenv().settings.ws:Disconnect()
		getgenv().settings.ws = nil
		return
	end
	
	getgenv().settings.ws = RunService.Heartbeat:Connect(function()
		game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = getgenv().settings.wsa
	end)
end

local function Fly(toggle)
	
	if (not toggle) then
		getgenv().settings.Fly:Disconnect()
		getgenv().settings.FlyBV:Destroy()
		getgenv().settings.Fly = nil;
		getgenv().settings.FlyBV = nil;
		return;
	end;

	getgenv().settings.FlyBV = Instance.new('BodyVelocity');
	getgenv().settings.FlyBV.MaxForce = Vector3.new(math.huge, math.huge, math.huge);

	getgenv().settings.Fly = RunService.Heartbeat:Connect(function()
		local rootPart, camera = Player.Character.HumanoidRootPart, workspace.CurrentCamera;
		if (not rootPart or not camera) then return end;


		getgenv().settings.FlyBV.Parent = rootPart;
		getgenv().settings.FlyBV.Velocity = camera.CFrame:VectorToWorldSpace(ControlModule:GetMoveVector() * getgenv().settings.flys);
	end);
end


local function noclip(t)
	if (not t) then
		getgenv().settings.Clip:Disconnect()
		getgenv().settings.Clip = nil
		for _,part in next, Player.Character:GetChildren() do
			if part:IsA("BasePart") or part:IsA("MeshPart") or part:IsA("Part") then
				part.CanCollide = true
			end
		end
		return
	end
	
	getgenv().settings.Clip = RunService.Heartbeat:Connect(function()
		for _,part in next, Player.Character:GetChildren() do
			if part:IsA("BasePart") or part:IsA("MeshPart") or part:IsA("Part") then
				part.CanCollide = false
			end
		end
	end)
end

function serverHop()
	local Http = game:GetService("HttpService")
	local TPS = game:GetService("TeleportService")
	local Api = "https://games.roblox.com/v1/games/"

	local _place = game.PlaceId
	local _servers = Api.._place.."/servers/Public?sortOrder=Asc&limit=100"
	function ListServers(cursor)
		local Raw = game:HttpGet(_servers .. ((cursor and "&cursor="..cursor) or ""))
		return Http:JSONDecode(Raw)
	end

	local Server, Next; repeat
		local Servers = ListServers(Next)
		Server = Servers.data[1]
		Next = Servers.nextPageCursor
	until Server

	TPS:TeleportToPlaceInstance(_place,Server.id,game.Players.LocalPlayer)
end


function autoBoss()
	repeat wait() until game:IsLoaded()
	if  game.PlaceId == 14069678431 then
		game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.PartyCreate:FireServer()


		fireclickdetector(workspace.NPCs.RaidBoss.Kisuke.ClickDetector)

		-- Script generated by SimpleSpy - credits to exx#9394
		wait(.5)
		local args = {
			[1] = "Yes"
		}

		game:GetService("Players").LocalPlayer.Kisuke:FireServer(unpack(args))
		
	elseif game.PlaceId == 14069122388 then
		local args = {
			[1] = "Karakura Town",
		}

		game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.ServerListTeleport:FireServer(unpack(args))
	end

	if game.PlaceId == 17047374266 then
		local plr = game.Players.LocalPlayer
		local boss
		local lapse = tick()
		_G.a = true
		_G.win = false
		game.Workspace.Entities.ChildAdded:Connect(function(v)

			if v.Name ~= plr.Name and v:GetAttribute("EntityType") and v.Name ~= "Wolf" or string.find(v.Name, "_") or v:GetAttribute("EntityType") == "Shinigami" or v:GetAttribute("EntityType") == "Quincy"  then

				boss = v

				local hum = boss:WaitForChild("Humanoid")
				local c 
				c = game:GetService("RunService").Heartbeat:Connect(function()
					if getgenv().settings.boss == true then
						if boss:GetAttribute("CurrentState") == "Unconscious" then
							print("Boss is dead")
							c:Disconnect()
							c = nil
							wait(1)
							plr.Character.HumanoidRootPart.CFrame =  boss.HumanoidRootPart.CFrame
							wait(.3)
							game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.Execute:FireServer()

							return	
						end

						if boss:GetAttribute("CurrentState") or boss:GetAtribute("BankaiMeter") then
							boss:SetAttribute("CurrentState", "Action")
							boss:SetAttribute("SkillRange", 0)
							boss:SetAttribute("Posture", 50)
							boss:SetAttribute("BankaiMeter", 0)
							boss:SetAttribute("MaxBankaiMeter", 0)
							boss:SetAttribute("Reiatsu", 0)
							boss:SetAttribute("MaxReiatsu", 0)
							boss:SetAttribute("DeflectFrames", false)
							boss:SetAttribute("BlockFrames", false)
							boss:SetAttribute("EvasiveFrames", false)
							boss:SetAttribute("HyperArmor", false)
							boss:SetAttribute("IFrames", false)
							boss:SetAttribute("ShikaiCD", true)
							boss:SetAttribute("SkillCD", true)
							boss:SetAttribute("One", false)
							boss:SetAttribute("Two", false)
							boss:SetAttribute("Three", false)
							boss:SetAttribute("Four", false)
							boss:SetAttribute("Five", false)
							boss:SetAttribute("Six", false)
							boss:SetAttribute("Seven", false)
							boss:SetAttribute("Seven", false)

							boss:SetAttribute("CriticalCooldown", true)

							boss.Humanoid.WalkSpeed = 0
							boss.Humanoid.JumpHeight = 0
						end

						plr.Character.HumanoidRootPart.CFrame =  boss.HumanoidRootPart.CFrame* CFrame.new(0,12,0) *CFrame.Angles(math.rad(-90),0,math.rad(90))

						if plr.Character:GetAttribute("One") ~= true then
							-- Script generated by SimpleSpy - credits to exx#9394

							local args = {
								[1] = "Skill",
								[2] = "One",
								[3] = "Pressed"
							}

							game:GetService("ReplicatedStorage").Remotes.ServerCombatHandler:FireServer(unpack(args))
						else
							local args = {
								[1] = "LightAttack"
							}

							game:GetService("ReplicatedStorage").Remotes.ServerCombatHandler:FireServer(unpack(args))
						end


						local args = {
							[1] = "LightAttack"
						}

						game:GetService("ReplicatedStorage").Remotes.ServerCombatHandler:FireServer(unpack(args))

					end

					wait()
				end)
			end

		end)


		local item
		game.Players.LocalPlayer.PlayerGui.ChildAdded:Connect(function(v)
			local timelapsed = (tick()-lapse)
			if v:IsA("ScreenGui") then
				for i2,v2 in pairs(v.Parent:GetDescendants()) do
					if v2:IsA("TextLabel") then
						if string.find(v2.Text, "obtained.") and getgenv().settings.webhook ~= false and getgenv().settings.webhookURL ~= "" then
							local nitem = string.gsub(v2.Text,"obtained.", "")
							item = nitem
							_G.win = true
							httpservice = game:GetService("HttpService")						
							local response = request({
								Url = getgenv().settings.webhookURL,
								Method = "POST",
								Headers = {
									["Content-Type"] = 'application/json'
								},
								Body = httpservice:JSONEncode({
									["content"] = "",
									["embeds"] = {{
										["title"] = "RAID BOSS WIN!",
										["description"] = "**Username: **"..game.Players.LocalPlayer.DisplayName.." \n **Item:** "..item,
										["type"] = "rich",
										["color"] = tonumber(0xd9abd7),
										["footer"] = {
											["text"] = "Meta Hub",
										}


									}}
								})
							})
						else
							print("Webhook not found.")
							return;
						end
					end
				end
			end
		end)

		game.Workspace.Entities.ChildRemoved:Connect(function(v)
			wait(2)
			if v.Name == boss.Name and getgenv().settings.webhook ~= false and getgenv().settings.webhookURL ~= "" and _G.win == false then
				httpservice = game:GetService("HttpService")

				local response = request({
					Url = getgenv().settings.webhookURL,
					Method = "POST",
					Headers = {
						["Content-Type"] = 'application/json'
					},
					Body = httpservice:JSONEncode({
						["content"] = "",
						["embeds"] = {{
							["title"] = "ERROR",
							["description"] = "**Reason:** Boss was bugged or timer ran out",
							["type"] = "rich",
							["color"] = tonumber(0xeb4034),
							["footer"] = {
								["text"] = "Meta Hub",
							}
						}}
					})
				})

				local args = {
					[1] = "Karakura Town",
				}

				game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.ServerListTeleport:FireServer(unpack(args))
			else
				print("Webhook not found")
				return
			end
		end)
	end
end

function sendTrade(a)
	if a then

		local args = {
			[1] = a
		}

		game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.Trade:InvokeServer(unpack(args))

	end
end

function tradeItem(a)
	-- Script generated by SimpleSpy - credits to exx#9394

	for i=4,1,-1 do
		local args = {
			[1] = "AddItem",
			[2] = a,
			[3] = i,
		}

		game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.TradeEvent:FireServer(unpack(args))
		wait(.1)
	end

end

function tradeAccept(a)
	local args = {
		[1] = "Accepted"
	}

	game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.TradeEvent:FireServer(unpack(args))

end

function antiVoid()
	local Start = tick()
	print(Start)
	local function tpToHM()

		wait(2)
		local args = {
			[1] = "Hueco Mundo",
		}

		game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.ServerListTeleport:FireServer(unpack(args))

	end

	local function tpTokt()

		wait(2)
		local args = {
			[1] = "Karakura Town",
		}

		game:GetService("Players").LocalPlayer.Character.CharacterHandler.Remotes.ServerListTeleport:FireServer(unpack(args))

	end


	game:GetService("GuiService").ErrorMessageChanged:Connect(function()
		game:GetService("TeleportService"):Teleport(14069678431, game:GetService("Players").LocalPlayer)
	end)
	game:GetService("RunService").RenderStepped:Connect(function()
		if game.PlaceId == 14069678431 and game:GetService("Players").LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
			game:GetService("Players").LocalPlayer.Character.HumanoidRootPart.Anchored = true
		end
		if (tick()-Start) >= 15	 and game.PlaceId == 14069678431 then
			tpToHM()
		elseif (tick()-Start) >= 800 and game.PlaceId == 17047374266 then
			tpToHM()
		end
	end)
end

loadsettings()

for i,v in pairs(getgenv().settings) do
	print(i,v)
end

if getgenv().settings.boss then
	autoBoss()
end

if getgenv().settings.antivoid then
	antiVoid()
end


local main = Library:CreateWindow()
local tab =	main:CreateTab("Player")
local tab2 = main:CreateTab("Misc")
local tab3 = main:CreateTab("Settings")

local sub = tab:createSubTab("MOVEMENT")
local sub2 = tab2:createSubTab("AUTO FARM")
local sub3 = tab3:createSubTab("SETTINGS")
local sub4 = tab2:createSubTab("TRADING")



sub:CreateToggle("Walkspeed",getgenv().settings.ws, function(a)
	getgenv().settings.ws = a
	
	while wait() do
		if getgenv().settings.ws == true then
			game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = getgenv().settings.wsa
		else
			game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 16
		end		
	end
end)

sub:CreateSlider("Walkspeed Amount",10,120,16, function(a)
	getgenv().settings.wsa = a
end)

sub:CreateToggle("Fly", getgenv().settings.Fly, function(a)	
	
	Fly(a)
	
end)


sub:CreateToggle("No Clip", getgenv().settings.Clip, function(a)
	noclip(a)
end)
sub:CreateSlider("Fly Speed",50,200,70, function(a)
	getgenv().settings.flys = a
end)


sub2:CreateToggle("Auto Farm Boss", getgenv().settings.boss, function(a)
	getgenv().settings.boss = a
	autoBoss()
	saveSettings()
end)
sub2:CreateToggle("Anti Void", getgenv().settings.antivoid, function(a)
	getgenv().settings.antivoid = a
	antiVoid()
	saveSettings()
end)

sub2:CreateButton("Server Hop", function(a)
	serverHop()
end)

sub3:CreateToggle("Webhook",getgenv().settings.webhook, function(a)
	getgenv().settings.webhook = a
	saveSettings()
end)

sub3:CreateTextbox("WebhookURL", "URL here", function(a)
	getgenv().settings.webhookURL = a
	saveSettings()
end)

sub4:CreateTextbox("Player", "Name", function(a)
	sendTrade(a)
end)

sub4:CreateTextbox("Item", "Name", function(a)
	tradeItem(a)
end)
sub4:CreateButton("Accept", function(a)
	tradeAccept()
end)
